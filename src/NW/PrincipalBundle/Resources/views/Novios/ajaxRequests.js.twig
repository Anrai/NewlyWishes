<script>
$(document).ready(function()
{
	$("form[name='nw_principalbundle_tareacalendario']").submit(submitForm);

	$('.completation').click(function(){

		var myID = $(this).data("id");
		var ajaxURL = "{{url('nw_principal_novios_tarea_calendario_operaciones')}}"+"/"+myID+"/completar";

		$.getJSON(ajaxURL, function(serverInfo){
			completar(serverInfo);
		});
		
		$("#"+myID).find(".completation").toggle();
		$("#"+myID).find(".descompletation").toggle();
	});

	$('.descompletation').click(function(){

		var myID = $(this).data("id");
		var ajaxURL = "{{url('nw_principal_novios_tarea_calendario_operaciones')}}"+"/"+myID+"/descompletar";

		$.getJSON(ajaxURL, function(serverInfo){
			descompletar(serverInfo);
		});

		$("#"+myID).find(".completation").toggle();
		$("#"+myID).find(".descompletation").toggle();
	});

	$('.elimination').click(function(){

		var myID = $(this).data("id");
		var ajaxURL = "{{url('nw_principal_novios_tarea_calendario_operaciones')}}"+"/"+myID+"/delete";

		$.getJSON(ajaxURL, function(serverInfo){
			eliminar(serverInfo);
		});

		$("#"+myID).remove();
		$("#tarea-"+myID).remove();
		$("tarea_descripcion_"+myID).remove();
	});
});

function completar(serverInfo){
    var completado = serverInfo.completado;

    if(completado){
	    return true;
	}
	else{
		return false;
	}
}

function descompletar(serverInfo){
    var descompletado = serverInfo.descompletado;

    if(descompletado){
	    return true;
	}
	else{
		return false;
	}
}

function eliminar(serverInfo){
    var eliminado = serverInfo.eliminado;

    if(eliminado){
	    return true;
	}
	else{
		return false;
	}
}

function submitForm(){

	var values = {};

	$.each($("form[name='nw_principalbundle_tareacalendario']").serializeArray(), function(i, field) {
		values[field.name] = field.value;
	});

	$.ajax({
		type        : 'POST',
		url         : $("form[name='nw_principalbundle_tareacalendario']").attr("action"),
		data        : values,
		success     : function(data) {
			if(data.responseCode == 200 ){
				return true;
			}
			else{
				alert("No se agreg√≥ la nueva tarea. Intente nuevamente: "+data.algunDato);
			}		
		}
	});
	return false;
}

</script>